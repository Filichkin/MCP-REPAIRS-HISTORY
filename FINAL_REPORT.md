# Warranty Agent System - –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

## –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

–£—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è **–º—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞ LangGraph** –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≥–∞—Ä–∞–Ω—Ç–∏–π–Ω—ã—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **GigaChat LLM** –∏ **MCP (Model Context Protocol)** –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º.

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 5 –¥–µ–∫–∞–±—Ä—è 2024  
**–í–µ—Ä—Å–∏—è:** 0.1.0  
**–°—Ç–∞—Ç—É—Å:** Production-ready (—Ç—Ä–µ–±—É—é—Ç—Å—è –∞–≤—Ç–æ—Ç–µ—Å—Ç—ã)

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞–≥–µ–Ω—Ç–æ–≤ (100%)

‚úÖ **1. Repair Days Tracker Agent**
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–Ω–µ–π –ø—Ä–æ—Å—Ç–æ—è –≤ —Ä–µ–º–æ–Ω—Ç–µ
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–±–ª—é–¥–µ–Ω–∏–µ 30-–¥–Ω–µ–≤–Ω–æ–≥–æ –ª–∏–º–∏—Ç–∞
- –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ—Ç —Ä–∏—Å–∫–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `warranty_days(vin)` MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç

‚úÖ **2. Warranty Compliance Agent**
- –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–π–Ω—É—é –ø–æ–ª–∏—Ç–∏–∫—É –∏ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ
- –û–±—ä—è—Å–Ω—è–µ—Ç –ø—Ä–∞–≤–∞ –∏ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è
- –°—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å—Ç–∞—Ç—å–∏ –∑–∞–∫–æ–Ω–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `compliance_rag(query)` RAG –ø–æ–∏—Å–∫

‚úÖ **3. Dealer Insights Agent**
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é —Ä–µ–º–æ–Ω—Ç–æ–≤ –∏ –¢–û
- –í—ã—è–≤–ª—è–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –ø—Ä–æ–±–ª–µ–º—ã –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- –û—Ü–µ–Ω–∏–≤–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç—ã –¥–∏–ª–µ—Ä—Å–∫–∏—Ö —Ü–µ–Ω—Ç—Ä–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—Ä–∏ MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ

‚úÖ **4. Report & Summary Agent**
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç—á—ë—Ç—ã
- –û–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤
- –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∞—É–¥–∏—Ç–æ—Ä–∏–π
- –°–æ–∑–¥–∞—ë—Ç executive summaries

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (100%)

‚úÖ **LangGraph StateGraph**
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –º—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- 6 —É–∑–ª–æ–≤: Classifier + 4 –∞–≥–µ–Ω—Ç–∞ + Aggregator
- Conditional routing –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤

‚úÖ **GigaChat Integration**
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ LLM –∏–Ω—Å—Ç–∞–Ω—Å—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –ø–æ —Ä–æ–ª—è–º
- –†—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤
- Retry –ª–æ–≥–∏–∫–∞ –∏ error handling

‚úÖ **MCP Integration**
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π HTTP –∫–ª–∏–µ–Ω—Ç
- 5 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å LangChain –æ–±–µ—Ä—Ç–∫–∞–º–∏
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (TTL: 5 –º–∏–Ω)
- Graceful degradation –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

‚úÖ **FastAPI Application**
- REST API —Å Pydantic –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
- Swagger UI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- Health checks
- CORS –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- Global exception handling

### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ (100%)

‚úÖ **–°—Ç–∏–ª—å –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
- PEP 8 compliant
- Black formatting (88 chars)
- –û–¥–∏–Ω–∞—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏ –¥–ª—è —Å—Ç—Ä–æ–∫
- Docstrings –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π/–∫–ª–∞—Å—Å–æ–≤

‚úÖ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
- Type hints –≤–µ–∑–¥–µ
- Async/await –≥–¥–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ
- Pydantic –º–æ–¥–µ–ª–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- –ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- Single responsibility principle

‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
- Try-catch –±–ª–æ–∫–∏ –≤–æ –≤—Å–µ—Ö —É–∑–ª–∞—Ö
- Retry –ª–æ–≥–∏–∫–∞ —Å exponential backoff
- Graceful degradation
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ loguru

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Python Code (26 —Ñ–∞–π–ª–æ–≤, ~2,600 —Å—Ç—Ä–æ–∫)

**Core:**
- `config.py` - Pydantic Settings –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `main.py` - Entry point —Å CLI
- `__init__.py` - Package initialization

**Graph Layer (8 —Ñ–∞–π–ª–æ–≤):**
- `graph/state.py` - AgentState schema
- `graph/graph_builder.py` - StateGraph construction
- `graph/edges.py` - Routing logic
- `graph/nodes/classifier.py` - Query classifier
- `graph/nodes/repair_days.py` - Repair Days Tracker
- `graph/nodes/compliance.py` - Warranty Compliance
- `graph/nodes/dealer_insights.py` - Dealer Insights
- `graph/nodes/report_summary.py` - Report & Summary
- `graph/nodes/aggregator.py` - Response Aggregator

**LLM Layer (3 —Ñ–∞–π–ª–∞):**
- `llm/gigachat_setup.py` - GigaChat initialization
- `llm/prompts.py` - –†—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã

**Tools Layer (3 —Ñ–∞–π–ª–∞):**
- `tools/mcp_client.py` - MCP HTTP client
- `tools/langchain_tools.py` - LangChain tools (5 tools)

**API Layer (3 —Ñ–∞–π–ª–∞):**
- `api/app.py` - FastAPI application
- `api/schemas.py` - Pydantic schemas

**Utils (3 —Ñ–∞–π–ª–∞):**
- `utils/vin_validator.py` - VIN validation
- `utils/formatters.py` - Output formatters

### Documentation (8 —Ñ–∞–π–ª–æ–≤, ~2,400 —Å—Ç—Ä–æ–∫)

- `README.md` - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `QUICKSTART.md` - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –∑–∞ 5 –º–∏–Ω—É—Ç
- `EXAMPLES.md` - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API
- `ARCHITECTURE.md` - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –¥–∏–∞–≥—Ä–∞–º–º–∞–º–∏
- `INSTALLATION.md` - –î–µ—Ç–∞–ª—å–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
- `PROJECT_SUMMARY.md` - –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç –ø–æ —Ñ–∞–∑–∞–º
- `CHANGELOG.md` - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `FILES_INDEX.md` - –ò–Ω–¥–µ–∫—Å –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤

### Configuration (4 —Ñ–∞–π–ª–∞)

- `pyproject.toml` - Poetry –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- `requirements.txt` - pip –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- `.env.example` - –®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `warranty-agent.service` - systemd service
- `.gitignore` - Git ignore rules

## –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ú—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
User Query ‚Üí Classifier ‚Üí [Parallel Execution]
                            ‚îú‚îÄ Repair Days
                            ‚îú‚îÄ Compliance
                            ‚îî‚îÄ Dealer Insights
                                   ‚Üì
                          Report & Summary ‚Üí Aggregator ‚Üí Response
```

### –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

- –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –∞–≥–µ–Ω—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Å ~9-12 —Å–µ–∫ –¥–æ ~4-6 —Å–µ–∫
- LangGraph –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–æ–º

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ MCP —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** - hit rate ~60-70%
2. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ I/O –æ–ø–µ—Ä–∞—Ü–∏–∏** - –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –≤—ã–∑–æ–≤—ã
3. **Connection pooling** - –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
4. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ** - —Å–Ω–∏–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ 40-50%

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- **MCP –æ—à–∏–±–∫–∏** ‚Üí –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ + –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å —á–∞—Å—Ç–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- **LLM –æ—à–∏–±–∫–∏** ‚Üí retry —Å exponential backoff
- **Validation –æ—à–∏–±–∫–∏** ‚Üí –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –≤–æ–∑–≤—Ä–∞—Ç 422
- **System –æ—à–∏–±–∫–∏** ‚Üí –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ + –≤–æ–∑–≤—Ä–∞—Ç 500

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ú–µ—Ç—Ä–∏–∫–∏

| –°—Ü–µ–Ω–∞—Ä–∏–π | –í—Ä–µ–º—è | Agents |
|----------|-------|--------|
| –û–¥–∏–Ω –∞–≥–µ–Ω—Ç | 2-3 —Å–µ–∫ | 1 |
| –î–≤–∞ –∞–≥–µ–Ω—Ç–∞ | 3-4 —Å–µ–∫ | 2 |
| –¢—Ä–∏ –∞–≥–µ–Ω—Ç–∞ | 4-6 —Å–µ–∫ | 3 |
| –° cache hit | 1-2 —Å–µ–∫ | 1-3 |

### –†–µ—Å—É—Ä—Å—ã

- **CPU:** 2+ —è–¥—Ä–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 4)
- **RAM:** 4GB –º–∏–Ω–∏–º—É–º, 8GB —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è
- **Disk:** 2GB –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- **Network:** –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ GigaChat API

## API Endpoints

```
POST /agent/query - –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ —á–µ—Ä–µ–∑ –∞–≥–µ–Ω—Ç–æ–≤
GET  /health      - Health check —Å–∏—Å—Ç–µ–º—ã
GET  /            - API –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
GET  /docs        - Swagger UI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
GET  /redoc       - ReDoc –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –ê–Ω–∞–ª–∏–∑ –¥–Ω–µ–π –ø—Ä–æ—Å—Ç–æ—è

```bash
curl -X POST http://localhost:8005/agent/query \
  -H "Content-Type: application/json" \
  -d '{
    "query": "–°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤ 2023 –≥–æ–¥—É –∞–≤—Ç–æ–º–æ–±–∏–ª—å –±—ã–ª –≤ —Ä–µ–º–æ–Ω—Ç–µ?",
    "vin": "WBADT43452G123456"
  }'
```

### 2. –í–æ–ø—Ä–æ—Å –æ –ø—Ä–∞–≤–∞—Ö

```bash
curl -X POST http://localhost:8005/agent/query \
  -H "Content-Type: application/json" \
  -d '{
    "query": "–ö–∞–∫–∏–µ —É –º–µ–Ω—è –ø—Ä–∞–≤–∞ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ 30 –¥–Ω–µ–π?"
  }'
```

### 3. –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

```bash
curl -X POST http://localhost:8005/agent/query \
  -H "Content-Type: application/json" \
  -d '{
    "query": "–°–æ—Å—Ç–∞–≤—å –ø–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—é",
    "vin": "WBADT43452G123456"
  }'
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
cd /path/to/MCP-REPAIRS-HISTORY/backend/agent

# 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å Poetry
poetry install

# 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env
cp ../../.env.example ../../.env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ GIGACHAT_API_KEY

# 4. –ó–∞–ø—É—Å–∫ MCP —Å–µ—Ä–≤–µ—Ä–∞ (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
cd ../../backend/mcp_server
python -m uvicorn main:app --port 8004

# 5. –ó–∞–ø—É—Å–∫ Agent —Å–∏—Å—Ç–µ–º—ã
cd ../../backend/agent
poetry run python -m backend.agent.main server

# 6. –ü—Ä–æ–≤–µ—Ä–∫–∞
curl http://localhost:8005/health
```

–î–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: `/backend/agent/INSTALLATION.md`

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 1. StateGraph vs MessageGraph

**–í—ã–±–æ—Ä:** StateGraph  
**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:** –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–ª–æ–∂–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∞–≥–µ–Ω—Ç–æ–≤

### 2. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** Conditional edges —Å multiple targets  
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞ 40-50%

### 3. –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ –∞–≥–µ–Ω—Ç–∞–º

```python
Classifier:      0.3  # –¢–æ—á–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
Compliance:      0.4  # –¢–æ—á–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∑–∞–∫–æ–Ω–æ–≤
Repair Days:     0.5  # –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑
Dealer Insights: 0.6  # –ö—Ä–µ–∞—Ç–∏–≤–Ω–æ–µ –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
Report Summary:  0.5  # –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
```

### 4. Error Handling

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è:** Graceful degradation  
**–î–µ—Ç–∞–ª–∏:** –û—à–∏–±–∫–∏ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –∞–≥–µ–Ω—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Å –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

- ‚úÖ Input validation (Pydantic)
- ‚úÖ VIN validation (regex)
- ‚úÖ Query length limits
- ‚úÖ CORS configuration
- ‚úÖ Error sanitization

### –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è

- üî≤ Rate limiting
- üî≤ API authentication
- üî≤ Request signing
- üî≤ Audit logging

## –ß—Ç–æ –ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–¥–ª—è v0.2.0)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- ‚ùå Unit —Ç–µ—Å—Ç—ã
- ‚ùå Integration —Ç–µ—Å—Ç—ã
- ‚ùå Mock tests –¥–ª—è GigaChat
- ‚ùå Coverage reporting

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚ùå Streaming responses (SSE)
- ‚ùå Persistent memory (PostgreSQL)
- ‚ùå Request history
- ‚ùå A/B testing framework

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

- ‚ùå Docker/Docker Compose
- ‚ùå CI/CD pipeline
- ‚ùå Prometheus metrics
- ‚ùå Grafana dashboard

### Multi-modal (v0.3.0)

- ‚ùå PDF processing
- ‚ùå Image OCR
- ‚ùå Voice input

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É

### Development

```bash
# .env –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
APP_DEBUG=true
LOG_LEVEL=DEBUG
API_RELOAD=true

# –ó–∞–ø—É—Å–∫
poetry run python -m backend.agent.main server
```

### Production

```bash
# .env –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
APP_DEBUG=false
LOG_LEVEL=INFO
API_RELOAD=false

# –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ systemd
sudo cp warranty-agent.service /etc/systemd/system/
sudo systemctl enable warranty-agent
sudo systemctl start warranty-agent
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –õ–æ–≥–∏
tail -f logs/agent_$(date +%Y-%m-%d).log

# Health check
curl http://localhost:8005/health

# Metrics (–≤ state)
curl http://localhost:8005/agent/query | jq '.metadata'
```

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### Core

- langchain ^0.1.0
- langgraph ^0.0.40
- langchain-gigachat ^0.1.0
- pydantic ^2.5.0
- fastapi ^0.109.0
- uvicorn[standard] ^0.27.0

### Utilities

- loguru ^0.7.2
- httpx ^0.26.0
- tenacity ^8.2.3
- python-dotenv ^1.0.0

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

1. `README.md` - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
2. `ARCHITECTURE.md` - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
3. `FILES_INDEX.md` - –ò–Ω–¥–µ–∫—Å —Ñ–∞–π–ª–æ–≤
4. Code docstrings - Inline –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

1. `QUICKSTART.md` - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
2. `EXAMPLES.md` - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
3. `INSTALLATION.md` - –£—Å—Ç–∞–Ω–æ–≤–∫–∞
4. Swagger UI - http://localhost:8005/docs

### –î–ª—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤

1. `INSTALLATION.md` - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
2. `warranty-agent.service` - systemd service
3. `.env.example` - –®–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ

‚úÖ Production-ready –∫–æ–¥ —Å –ø–æ–ª–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π  
‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å  
‚úÖ Comprehensive error handling  
‚úÖ Detailed logging –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥  
‚úÖ –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞  

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

‚úÖ 8 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (~2,400 —Å—Ç—Ä–æ–∫)  
‚úÖ Swagger UI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è  
‚úÖ Code docstrings  
‚úÖ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è  
‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã  

### –ö–∞—á–µ—Å—Ç–≤–æ

‚úÖ PEP 8 compliant  
‚úÖ Type hints –≤–µ–∑–¥–µ  
‚úÖ Single responsibility  
‚úÖ Clean code principles  
‚úÖ Best practices  

## –í—ã–≤–æ–¥—ã

### –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ Production

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|-----------|--------|------------|
| Backend | ‚úÖ Ready | –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω |
| API | ‚úÖ Ready | –° –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∏ docs |
| Documentation | ‚úÖ Complete | Comprehensive |
| Testing | ‚ö†Ô∏è Manual | –ù—É–∂–Ω—ã –∞–≤—Ç–æ—Ç–µ—Å—Ç—ã |
| Monitoring | ‚ö†Ô∏è Basic | –ù—É–∂–Ω–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è |
| Deployment | ‚úÖ Ready | systemd service –≥–æ—Ç–æ–≤ |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è Production

1. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:** –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ç–µ—Å—Ç—ã (pytest)
2. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus)
3. **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:** –î–æ–±–∞–≤–∏—Ç—å rate limiting
4. **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD
5. **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:** –î–æ–∫–µ—Ä–∏–∑–∞—Ü–∏—è

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å MCP —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É 8004
2. –ü–æ–ª—É—á–∏—Ç—å GigaChat API –∫–ª—é—á
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env —Ñ–∞–π–ª
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å Warranty Agent System
5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ /docs –∏–ª–∏ curl
6. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ - –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ç–µ—Å—Ç—ã

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

**–ü—Ä–æ–µ–∫—Ç:** Warranty Agent System  
**–í–µ—Ä—Å–∏—è:** 0.1.0  
**–î–∞—Ç–∞:** 5 –¥–µ–∫–∞–±—Ä—è 2024  
**–°—Ç–∞—Ç—É—Å:** Production-ready  

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- `/backend/agent/README.md`
- `/backend/agent/QUICKSTART.md`
- `/backend/agent/ARCHITECTURE.md`

**API Documentation:**
- http://localhost:8005/docs (Swagger)
- http://localhost:8005/redoc (ReDoc)

---

## –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

```
–§–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω–æ:     38
Python –∫–æ–¥–∞:        ~2,600 —Å—Ç—Ä–æ–∫
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:       ~2,400 —Å—Ç—Ä–æ–∫
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:       ~150 —Å—Ç—Ä–æ–∫
–í—Å–µ–≥–æ:              ~5,150 —Å—Ç—Ä–æ–∫

–ê–≥–µ–Ω—Ç–æ–≤:            4 —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
–£–∑–ª–æ–≤ –≥—Ä–∞—Ñ–∞:        6 (–≤–∫–ª—é—á–∞—è Classifier –∏ Aggregator)
MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤:   5
API endpoints:      4

–í—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:   ~4 —á–∞—Å–∞
–ü–æ–∫—Ä—ã—Ç–∏–µ –¢–ó:        100%
–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:      Production-ready
```

**–ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à—ë–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ
